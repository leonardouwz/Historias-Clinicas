




------------------ ROL: recepcion_db

--1. Insertar nuevo paciente – ✅ Permitido

EXECUTE AS USER = 'recepcion_db';

INSERT INTO Pacientes (nombre_completo, dni, fecha_nacimiento, genero)
VALUES ('Lucía suarez', '45612379', '1990-03-23', 'F');

REVERT;

SELECT * FROM Pacientes WHERE dni = '45612379';

---2. Crear consulta – ✅ Permitido

EXECUTE AS USER = 'recepcion_db';

EXEC SP_CrearConsulta 
    @id_paciente = (SELECT id_paciente FROM Pacientes WHERE dni = '45612378'),
    @id_medico = 1,  -- Asegúrate que este ID exista
    @sintomas = 'Dolor de cabeza';

REVERT;

SELECT TOP 5 * FROM Consultas ORDER BY fecha_consulta DESC;

----3. Eliminar consulta – ❌ No permitido
EXECUTE AS USER = 'recepcion_db';

DELETE FROM Consultas WHERE id_consulta = 3;

REVERT;

select * From Consultas

-- 4. Ver médicos – ✅ Permitido (solo lectura)

EXECUTE AS USER = 'recepcion_db';

SELECT nombre_completo FROM Medicos;

REVERT;

--5. Ver historial de cambios – ❌ No permitido

EXECUTE AS USER = 'recepcion_db';

SELECT * FROM HistorialCambios;

REVERT;
